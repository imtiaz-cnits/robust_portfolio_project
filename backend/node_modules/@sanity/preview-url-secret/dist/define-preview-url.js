import{u as e,b as n}from"./_chunks/constants-mg9CwKOs.js";function t(t){const{draftMode:a,previewMode:o,origin:r=("undefined"==typeof location?"https://localhost":location.origin)}=t,i=(null==o?void 0:o.enable)||(null==a?void 0:a.enable);let{preview:c="/"}=t;const s=new URL(c,r),h=i?new URL(i,r):void 0;return async a=>{try{if(a.previewSearchParam){const e=new URL(a.previewSearchParam,s);e.origin===s.origin&&(c="".concat(e.pathname).concat(e.search))}else if(a.referrer){const e=new URL(a.referrer);e.origin===s.origin&&(c="".concat(e.pathname).concat(e.search))}}catch{}"undefined"!=typeof location&&location.origin===s.origin&&a.studioBasePath&&(c.startsWith("".concat(a.studioBasePath,"/"))||c===a.studioBasePath)&&(c=t.preview||"/");const o=new URL(c,s);if(h){const t=new URL(h),{searchParams:r}=t;return r.set(e,a.previewUrlSecret),o.pathname!==t.pathname&&r.set(n,"".concat(o.pathname).concat(o.search)),t.toString()}return o.toString()}}export{t as definePreviewUrl};//# sourceMappingURL=define-preview-url.js.map
